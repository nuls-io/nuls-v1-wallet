webpackJsonp([8],{ZSLJ:function(t,e){},eD5G:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("LPk9"),n=s("KcW0"),o=s("6ROu"),d=s.n(o),r=s("FJop"),i=s("x47x"),g={data:function(){return{address:"",agentAddress:this.$route.query.agentAddress,agentHash:this.$route.query.agentHash,agentAddressInfo:[],myMortgageData:[],total:0,pageNumber:"1",outInfo:{address:"",txHash:""},myNodeSetInterval:null,toCheckOk:!1}},components:{Back:a.a,ProgressBar:n.a,Password:r.a},mounted:function(){var t=this;this.getAgentAddressInfo("/consensus/agent/"+this.agentHash),this.getAddressList("/consensus/deposit/address/"+localStorage.getItem("newAccountAddress"),{agentHash:this.agentHash,pageSize:"10",pageNumber:this.pageNumber}),this.myNodeSetInterval=setInterval(function(){t.getAgentAddressInfo("/consensus/agent/"+t.agentHash),t.getAddressList("/consensus/deposit/address/"+localStorage.getItem("newAccountAddress"),{agentHash:t.agentHash,pageSize:"10",pageNumber:t.pageNumber})},5e3)},destroyed:function(){clearInterval(this.myNodeSetInterval)},methods:{getAgentAddressInfo:function(t,e){var s=this;this.$fetch(t,e).then(function(t){if(t.success){var e=new i.BigNumber(1e-8);s.toCheckOk=t.data.agentAddress===localStorage.getItem("newAccountAddress"),t.data.deposit=parseFloat(e.times(t.data.deposit).toString()),t.data.creditVals=t.data.creditVal,t.data.creditVal=((t.data.creditVal+1)/2*100).toFixed().toString()+"%",t.data.agentAddresss=t.data.agentAddress.substr(0,10)+"..."+t.data.agentAddress.substr(-10),t.data.totalDeposits=(1e-8*t.data.totalDeposit).toFixed(0)+"/500000",t.data.totalDeposit>5e13?t.data.totalDeposit="100%":t.data.totalDeposit=(t.data.totalDeposit/5e11).toString()+"%",s.agentAddressInfo=t.data}})},getAddressList:function(t,e){var s=this;this.$fetch(t,e).then(function(t){if(t.success){var e=new i.BigNumber(1e-8);s.total=t.data.total;for(var a=0;a<t.data.list.length;a++)t.data.list[a].deposit=parseFloat(e.times(t.data.list[a].deposit).toString()),t.data.list[a].time=d()(t.data.list[a].time).format("YYYY-MM-DD HH:mm:ss");s.myMortgageData=t.data.list}})},myMortgageSize:function(t){this.pageNumber=t,this.getAddressList("/consensus/deposit/address/"+localStorage.getItem("newAccountAddress"),{agentHash:this.agentAddress,pageSize:"10",pageNumber:t})},toCheck:function(){this.$router.push({path:"/consensus/nodeInfo",query:{agentHash:this.agentAddressInfo.agentHash}})},addNode:function(){this.$store.getters.getNetWorkInfo.localBestHeight===this.$store.getters.getNetWorkInfo.netBestHeight?this.$router.push({path:"/consensus/myNode/addNode",query:{agentAddress:this.agentAddress,agentId:this.agentAddressInfo.agentHash}}):this.$message({message:this.$t("message.c133")})},outNode:function(t){var e=this;this.$fetch("/consensus/withdraw/fee?address="+t.address+"&depositTxHash="+t.txHash).then(function(s){if(s.success){var a=new i.BigNumber(1e-8);e.$confirm(e.$t("message.c61")+t.deposit+" NULS "+e.$t("message.c60")+t.agentName+e.$t("message.miningFee")+a.times(s.data.value)+" NULS","",{confirmButtonText:e.$t("message.confirmButtonText"),cancelButtonText:e.$t("message.cancelButtonText")}).then(function(){e.outInfo.address=t.address,e.outInfo.txHash=t.txHash,"true"===localStorage.getItem("encrypted")?e.$refs.password.showPassword(!0):e.toSubmit("")}).catch(function(){e.$message({type:"info",message:e.$t("message.c59")})})}else console.log("get fee err")})},toSubmit:function(t){var e=this,s={address:this.outInfo.address,password:t,txHash:this.outInfo.txHash};this.$post("/consensus/withdraw/",s).then(function(t){t.success?(e.$message({type:"success",message:e.$t("message.passWordSuccess")}),e.getAddressList("/consensus/deposit/address/"+localStorage.getItem("newAccountAddress"),{agentHash:e.agentHash,pageSize:"10",pageNumber:e.pageNumber})):e.$message({type:"warning",message:e.$t("message.passWordFailed")+t.data.msg}),e.outInfo.address="",e.outInfo.txHash=""})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-node"},[s("Back",{attrs:{backTitle:this.$t("message.consensusManagement")}}),t._v(" "),s("h2",[t._v(t._s(this.agentAddressInfo.agentId))]),t._v(" "),s("div",{staticClass:"div-icon1 node-page-top"},[s("p",{staticClass:"subscript",class:0===this.agentAddressInfo.status?"stay":""},[t._v("\n      "+t._s(t.$t("message.status"+this.agentAddressInfo.status))+"\n    ")]),t._v(" "),s("ul",[s("li",{staticClass:"li-bg overflow"},[s("label",[t._v(t._s(t.$t("message.c16"))+"：")]),t._v(t._s(this.agentAddressInfo.agentName?this.agentAddressInfo.agentName:this.agentAddressInfo.agentAddresss)+"\n        "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.toCheckOk,expression:"toCheckOk"}],staticClass:"cursor-p text-d",on:{click:t.toCheck}},[t._v(t._s(t.$t("message.c5_1")))])]),t._v(" "),s("li",[s("label",[t._v(t._s(t.$t("message.c17"))+"：")]),t._v(t._s(this.agentAddressInfo.commissionRate)+"%\n      ")]),t._v(" "),s("li",[s("label",[t._v(t._s(t.$t("message.c25"))+"：")]),t._v(t._s(this.agentAddressInfo.deposit)+"\n        NULS\n      ")]),t._v(" "),s("li",[s("label",[t._v(t._s(t.$t("message.c19"))+"：")]),t._v(t._s(this.agentAddressInfo.memberCount)+"\n      ")]),t._v(" "),s("li",[s("label",[t._v(t._s(t.$t("message.c18"))+"：")]),t._v(" "),s("ProgressBar",{attrs:{colorData:this.agentAddressInfo.creditVals<0?"#f64b3e":"#82bd39",widthData:this.agentAddressInfo.creditVal}}),t._v(" "),s("span",[t._v(" "+t._s(this.agentAddressInfo.creditVals))])],1),t._v(" "),s("li",[s("label",[t._v(t._s(t.$t("message.c47"))+"：")]),t._v(" "),s("ProgressBar",{attrs:{colorData:"#58a5c9",widthData:this.agentAddressInfo.totalDeposit}}),t._v(" "),s("span",[t._v(" "+t._s(this.agentAddressInfo.totalDeposits))])],1)])]),t._v(" "),s("div",{staticClass:"my-node-bottom"},[s("div",{staticClass:"my-node-list"},[t._v("\n      "+t._s(t.$t("message.c56"))+"\n      "),s("span",{staticClass:"text-d cursor-p fr",on:{click:t.addNode}},[t._v(t._s(t.$t("message.c57")))])]),t._v(" "),s("el-table",{attrs:{data:t.myMortgageData}},[s("el-table-column",{attrs:{prop:"deposit",label:t.$t("message.c51"),"min-width":"100",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:t.$t("message.state"),width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.$t("message.status"+e.row.status))+"\n        ")]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"time",label:t.$t("message.c49"),"min-width":"85",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:t.$t("message.operation"),align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){t.outNode(e.row)}}},[t._v(t._s(t.$t("message.c58"))+"\n          ")])]}}])})],1),t._v(" "),s("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.totalOK=this.total>10,expression:"totalOK = this.total > 10 ? true:false"}],staticClass:"cb",attrs:{layout:"prev, pager, next","page-size":10,total:this.total},on:{"current-change":t.myMortgageSize}})],1),t._v(" "),s("Password",{ref:"password",on:{toSubmit:t.toSubmit}})],1)},staticRenderFns:[]};var l=s("vSla")(g,c,!1,function(t){s("ZSLJ")},null,null);e.default=l.exports}});